{% extends "lotes/base_lotes.html" %}
{% block header_scripts %}

<script type="text/javascript">
	$(document).ready(function() {
	var d=new Date();
	var curr_date = d.getDate();
	var curr_month = d.getMonth();
	var curr_year = d.getFullYear();
	if (curr_date<10){
		curr_date="0"+curr_date.toString();
	}
	var hoy=(curr_date + "/" + curr_month+ "/" + curr_year);
	$("#fecha_fin").val(hoy);
	$('#lote_id').mask('###/###/####');
	$('#fecha_ini').mask('##/##/####');
	$("#fecha_ini").datepicker({ dateFormat: 'dd/mm/yy' });
	$('#fecha_fin').mask('##/##/####');
	$("#fecha_fin").datepicker({ dateFormat: 'dd/mm/yy' });
	

	lista_totales=[];

	lista_totales[1]="0";
	lista_totales[2]="0";
	lista_totales[3]="0";

	{%for lt in lista_totales%}
	lista_totales[{{forloop.counter}}]=
	"{{lt}}";
	{%endfor%}

	fila = "<td colspan='8'>Liquidacion:</td><td>" + lista_totales[1] + "</td><td>" + lista_totales[2] + "</td><td>" + lista_totales[3] + "</td>";
	$('#fila_totales').html(fila);
	$('#fila_totales').show();

	});

	function validar() {
		/*
		 if($('#fecha_ini').val()=="" || $('#fecha_fin').val()=="") {
		 alert("Debe ingresar un rango de fechas");
		 return;
		 }
		 */
		if ($('#lote_id').val() == 0 || $('#lote_id').val() == "") {
			alert("Debe ingresar un lote");
			return;
		}
		$("#frm_busqueda").submit();
	}

</script>
{% endblock %}
{% block content %}
<div class="gri16 text-izquierda" id="breadcumb">
	<a href="/">Inicio</a><span class="verde-1">></span>
	<a href="/informes/">Informes</a>
	<span class="verde-1">> Informe general de movimientos</span>
</div>

<div class="clear"></div>

<div class="grid_10">
	<h1>Informe General de Movimientos de lotes </h1>
</div>

<div class="grid_6">
	<form name="frm_busqueda" id="frm_busqueda" method="post" action="/informes/informe_movimientos/">
		{% csrf_token %}
		<table>
			<tr>
				<td> Lote: </td>
				<td>
				<input name="lote_id" id="lote_id" type="text" value=""/>
				</td>

			</tr>
			<th></th><th>Desde:</th><th>Hasta:</th>
			<tr>
				<td> Rango de Fecha: </td>
				<td>
				<input name="fecha_ini" id="fecha_ini" type="text" value="" />
				</td>
				<td>
				<input name="fecha_fin" id="fecha_fin" type="text" value="" />
				</td>
			</tr>

			<tr>
				<td>
				<input type="button" value="Buscar" onclick="validar();" class="historico" style="cursor: pointer"/>
				</td>
				<td>
				<input name="tabla" type="hidden" value="lote"/>
				</td>
			</tr>
		</table>

	</form>
</div>

<div class="clear"></div>
<div id="listado-cuadro-busqueda">

	<br>
	<br>
</div>
<div id="listado-item-lote">

	{%if lista_ventas %}
	<h1>Listado de ventas</h1>
	<table width="50%" border="1" cellpadding="0" cellspacing="0" class="listado-ventas" align="center">
		<th>Venta Nro</th><th>Lote Nro</th><th>Fracci&oacute;n</th><th>Cliente</th><th>Vendedor</th><th>Fecha de Venta</th><th>Precio Final de Venta</th>
		{% for lv in lista_ventas %}
		{%for lot in hw%}
		<tr>
			<td> {{lot.id}} </td>
			<td> {{lot.lote}} </td>
			<td> {{lot.lote.manzana.fraccion_id}} </td>
			<td> {{lot.cliente}} </td>
			<td> {{lot.vendedor}} </td>
			<td> {{lot.fecha_de_venta}} </td>
			<td> {{lot.precio_final_de_venta}} </td>
		</tr>
		{%endfor%}
		{% endfor %}
		{%endif%}
	</table>
</div>

<div class="pagination">
	<span class="step-links">
		<div class="pagination">
			<span class="step-links"> {%if listaP.has_previous%} <a href="?page={{ listaP.previous_page_number }}"> Anterior</a> {%endif%}
				P&aacute;gina
				|{{listaP.number}}|

				{%if listaP.has_next%} <a href="?page={{ listaP.next_page_number }}"> Siguiente</a> {%endif%} </span>
		</div>
		<div id="footer">
			<a href="/movimientos" class="boton-verde">Volver al m√≥dulo de Movimientos</a>
		</div> {% endblock %}
