{% extends "lotes/base_lotes.html" %}
{% block header_scripts %}

<script type="text/javascript">
	$(document).ready(function() {

	var fecha_ini = "{{fecha_ini}}";
	var fecha_fin= "{{fecha_fin}}";
	var tipo_busqueda="{{tipo_busqueda}}";
	var busqueda="{{busqueda}}";

	$('#fecha_ini').val(fecha_ini);
	$('#fecha_fin').val(fecha_fin);
	$('#id_tipo_busqueda').val(tipo_busqueda);
	$('#id_busqueda').val(busqueda);

	$('#fecha_ini').mask('##/##/####');
	$("#fecha_ini").datepicker({ dateFormat: 'dd/mm/yy' });
	$('#fecha_fin').mask('##/##/####');
	$("#fecha_fin").datepicker({ dateFormat: 'dd/mm/yy' });

	lista_totales=[];

	lista_totales[1]="0";
	lista_totales[2]="0";
	lista_totales[3]="0";

	{%for lt in lista_totales%}
	lista_totales[{{forloop.counter}}]=
	"{{lt}}";
	{%endfor%}

	fila = "<td colspan='4'>Liquidacion:</td><td>" + lista_totales[1] + "</td><td>" + lista_totales[2] + "</td><td>" + lista_totales[3] + "</td>";
	$('#fila_totales').html(fila);
	$('#fila_totales').show();
	});

	function retrieve_liquidacion_propietarios() {

		window.location.href = "/informes/liquidacion_propietarios_reporte_excel?fecha_ini=" + $('#fecha_ini').val() + "&fecha_fin=" + $('#fecha_fin').val() + "&tipo_busqueda=" + $('#id_tipo_busqueda').val() + "&busqueda=" + $('#id_busqueda').val();
	}

	function validar() {
		if ($('#fecha_ini').val() == "" || $('#fecha_fin').val() == "") {
			alert("Debe ingresar un rango de fechas");
			return;
		}
		if ($('#fraccion_ini').val() == 0 || $('#fraccion_fin').val() == 0 || $('#fraccion_ini').val() == "" || $('#fraccion_fin').val() == "") {
			alert("Debe ingresar un rango de fracciones");
			return;
		}
		$("#frm_busqueda").submit();
	}

</script>
{% endblock %}
{% block content %}
<div class="gri16 text-izquierda" id="breadcumb">
	<a href="/">Inicio</a><span class="verde-1">></span>
	<a href="/informes/">Informes</a>
	<span class="verde-1">>Liquidaci&oacute;n de Propietarios</span>
</div>

<div class="clear"></div>


<h1>Liquidaci&oacute;n de Propietarios</h1>


<div class="grid_6">
	<form name="frm_busqueda" id="frm_busqueda" method="get" action="/informes/liquidacion_propietarios/">
		
		<table id="lista-categoria" frame="box">
			<tr>
			<th class="acciones" colspan="3"><strong><a href="#" style="color: white;">Filtrar</a></strong></th>
			</tr>
			<tr>
				<td>
				<select id="id_tipo_busqueda" name="tipo_busqueda">
					<option value="">Elija una opcion</option>
					<option value="fraccion">Fraccion</option>
					<option value="propietario">Propietario</option>
				</select></td>
				<td>
				<input name="busqueda" id="id_busqueda" type="text" value=""/>
				</td>
			</tr>

			<th></th><th>Desde:</th><th>Hasta:</th>
			<tr>
				<td> Rango de Fecha: </td>
				<td>
				<input name="fecha_ini" id="fecha_ini" type="text" value="" />
				</td>
				<td>
				<input name="fecha_fin" id="fecha_fin" type="text" value="" />
				</td>
			</tr>
			<tr>
				<td>
				<input type="button" value="Buscar" onclick="validar();" class="historico" style="cursor: pointer"/>
				</td>
				<td>
				<a class="boton-verde" id="id_boton" onclick="retrieve_liquidacion_propietarios();">Descargar como Excel</a>
				</td>
			</tr>
		</table>

	</form>

</div>

<div class="clear"></div>
<div id="listado-cuadro-busqueda">

	<br>
	<br>
</div>
<div id="listado-item-lote">
	<table width="50%" border="1" cellpadding="0" cellspacing="0" class="listado-pagos" align="center">
		<th>Fecha</th><th>Lote</th><th>Cliente</th><th>Cuota Nº</th><th>Monto Pagado</th><th>Monto Inmobiliaria</th><th>Monto Propietario</th>

		{% for hw in object_list %}

		<tr>
			<td>{{hw.0}}</td>
			<td>{{hw.1}}</td>
			<td>{{hw.2}}</td>
			<td>{{hw.3}}</td>
			<td>{{hw.4}}</td>
			<td>{{hw.5}}</td>
			<td>{{hw.6}}</td>
		</tr>

		<tr id='fila-{{forloop.counter}}' style="display: none;"></tr>
		{% endfor %}
		<tr id='fila_totales' style="display: none;"></tr>
		<div class="pagination">
			<span class="step-links"> {%if object_list.has_previous%} <a href="?page={{ object_list.previous_page_number }}"> Anterior</a> {%endif%}
				P&aacute;gina
				|{{object_list.number}}|

				{%if object_list.has_next%} <a href="?page={{ object_list.next_page_number }}"> Siguiente</a> {%endif%} </span>
		</div>
	</table>
</div>

<div id="footer">
	<a href="/informes" class="boton-verde">Volver al módulo de Informes</a>
</div>
{% endblock %}