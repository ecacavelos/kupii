{% extends "lotes/base_lotes.html" %}
{% block header_scripts %}
    <script type="text/javascript">
        $(document).ready(function () {
            $('#fecha_hasta').mask('##/##/####');
            $("#fecha_hasta").datepicker({dateFormat: 'dd/mm/yy'});
            $("#fecha_hasta").hide();
        });
        function buscar() {
            if ($("#tipo_busqueda").val() == 0) {
                alert("Debe elegir un tipo de busqueda.");
            }
            else {
                if ($("#busqueda").val() == "") {
                    alert("Debe ingresar un nombre para buscar.");
                } else {
                    $("#frm_busqueda").submit();
                }
            }
        }
        function desplegar_fecha() {
            if ($("#tipo_busqueda").val() == 'fecha') {
                $("#fecha_hasta").show();
                $('#busqueda').mask('##/##/####');
                $("#busqueda").datepicker({dateFormat: 'dd/mm/yy'});
            } else {
                $("#fecha_hasta").hide();
                $("#busqueda").datepicker("destroy");
                $("#busqueda").removeClass("hasDatepicker");
                $("#busqueda").unmask();
                $("#fecha_hasta").val("");
                $("#busqueda").val("");
            }
        }
    </script>
{% endblock %}
{% block content %}
    <div class="gri16 text-izquierda" id="breadcumb">
        <a href="{% url 'frontend_home' %}">Inicio</a> <span class="verde-1">></span>
        <a href="{% url 'frontend_home' %}movimientos/">Movimientos</a>
        <span class="verde-1">> Listado de Cambios</span>
    </div>
    <div class="clear"></div>

    <h1>Listado de Cambios</h1>

    <div class="grid_6">
        <form name="frm_busqueda" id="frm_busqueda" method="get" action="/movimientos/listado_busqueda_cambios/">
            <table id="lista-categoria" frame="box">
                <tr>
                    <th class="acciones" colspan="3"><strong><a href="#" style="color: white;">Filtrar</a></strong></th>
                </tr>
                <tr>
                    <td>
                        <select id="tipo_busqueda" name="tipo_busqueda" onchange="desplegar_fecha();">
                            <!-- <option value="0">Elija una opcion</option> -->
                            <option value="cliente">Cliente</option>
                            <option value="fecha">Fecha de Cambio</option>
                        </select></td>
                </tr>
                <tr>
                    <td>
                        <input id="busqueda" name="busqueda"/>

                        <input name="fecha_hasta" id="fecha_hasta" type="text" value=""/>
                        <input name="tabla" type="hidden" value="venta"/>

                        <input type="button" value="Buscar" onclick="buscar();" class="historico"
                               style="cursor: pointer"/>
                    </td>
                </tr>
            </table>
        </form>
    </div>

    <div class="clear"></div>
    <div id="listado-cuadro-busqueda">
        <a href="{% url 'frontend_home' %}movimientos/cambio_lotes" class="boton-verde">Agregar Cambio</a>
        <br><br>
    </div>
    <div id="listado-item-lote">
        <table width="50%" cellpadding="0" cellspacing="0" class="listado-lotes" align="center">
            <th>Codigo</th>
            <th>Cliente</th>
            <th>Fecha de Cambio</th>
            <th>Lote Anterior</th>
            <th>Lote Nuevo</th>
            {% if busqueda == 'cliente' %}
                {% for hw in object_list %}
                    {% for lot in hw %}
                        <tr>
                            <td>
                                {{ lot.id }}
                            </td>
                            <td>
                                {{ lot.cliente }}
                            </td>
                            <td>
                                {{ lot.fecha_de_cambio }}
                            </td>
                            <td>
                                {{ lot.lote_a_cambiar }}
                            </td>
                            <td>
                                {{ lot.lote_nuevo }}
                            </td>

                        </tr>



                    {% endfor %}
                {% endfor %}
            {% else %}
                {% for hw in object_list %}
                    <tr>
                        <td>
                            {{ hw.id }}
                        </td>
                        <td>
                            {{ hw.cliente }}
                        </td>
                        <td>
                            {{ hw.fecha_de_cambio }}
                        </td>
                        <td>
                            {{ hw.lote_a_cambiar }}
                        </td>
                        <td>
                            {{ hw.lote_nuevo }}
                        </td>

                    </tr>

                {% endfor %}
            {% endif %}
            <div class="pagination">
    <span class="step-links">
        <div class="pagination">
    <span class="step-links">
        {% if object_list.has_previous %}
            <a href="?page={{ object_list.previous_page_number }}{{ ultima_busqueda }}"> Anterior</a>
        {% endif %}
        P&aacute;gina
    	|{{ object_list.number }}|

        {% if object_list.has_next %}
            <a href="?page={{ object_list.next_page_number }}{{ ultima_busqueda }}"> Siguiente</a>
        {% endif %}
    </span>
        </div>
        </table>
    </div>

    <div id="footer"><a href="{% url 'frontend_home' %}movimientos" class="boton-verde">Volver al m√≥dulo de
        Movimientos</a></div>
{% endblock %}